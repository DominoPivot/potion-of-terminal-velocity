{
  "version": 3,
  "sources": ["../src/utils.ts", "../src/terminal.ts", "../src/game.ts", "../src/entrypoint.ts"],
  "sourcesContent": ["/** Selects an element in the document and assert its type. */\nexport function ref<T extends HTMLElement> (selector: string, constructor: { new(): T; }) {\n\tconst el = document.querySelector(selector);\n\tif (!el)\n\t\tthrow Error(`No match for selector: ${selector}`);\n\tif (!(el instanceof constructor))\n\t\tthrow Error(`Expected ${constructor.name} but found ${el.constructor.name} for selector: ${selector}`);\n\treturn el;\n}\n\n/** Selects elements in the document and assert their type. */\nexport function refArray<T extends HTMLElement> (selector: string, constructor: { new(): T; }) {\n\tconst arr = Array.from(document.querySelectorAll(selector));\n\tif (!arr.length)\n\t\tthrow Error(`No match for selector: ${selector}`);\n\tconst intruder = arr.find(el => !(el instanceof constructor));\n\tif (intruder)\n\t\tthrow Error(`Expected ${constructor.name} but found ${intruder.constructor.name} for selector: ${selector}`);\n\treturn arr;\n}\n", "export type TerminalConfig = {\n\tpromptElement: HTMLElement,\n\tinputElement: HTMLInputElement,\n\toutputElement: HTMLElement,\n\tonUserInput: (userInput: string) => void,\n};\n\nexport type Terminal = {\n\tprompt: string\n\treadonly log: (message: string, loglevel?: \"log\" | \"error\") => void;\n};\n\nexport function createTerminal ({ promptElement, inputElement, outputElement, onUserInput }: TerminalConfig) {\n\tlet samp: HTMLElement | undefined;\n\tlet prompt: string = promptElement.textContent ?? \"\";\n\n\tfunction echo (userInput: string) {\n\t\tconst kbdElement = document.createElement(\"kbd\");\n\t\tkbdElement.textContent = userInput;\n\n\t\tsamp = document.createElement(\"samp\");\n\t\tsamp.append(prompt, kbdElement, \"\\n\");\n\t\toutputElement.appendChild(samp);\n\t}\n\n\tfunction log (message: string, loglevel: \"log\" | \"error\" = \"log\") {\n\t\tif (message === \"\") {\n\t\t\tsamp = undefined;\n\t\t\treturn;\n\t\t}\n\t\tif (!message.endsWith(\"\\n\")) {\n\t\t\tmessage += \"\\n\";\n\t\t}\n\t\tconst span = document.createElement(\"span\");\n\t\tspan.className = loglevel;\n\t\tspan.textContent = message;\n\n\t\tsamp ??= document.createElement(\"samp\");\n\t\tsamp.appendChild(span);\n\t\toutputElement.appendChild(samp);\n\t\tsamp = undefined;\n\t}\n\n\tinputElement.addEventListener(\"keydown\", function onCommandLineKeyDown (event: KeyboardEvent) {\n\t\tif (event.key === \"Enter\") {\n\t\t\tconst userInputString = this.value;\n\t\t\tthis.value = \"\";\n\t\t\techo(userInputString);\n\t\t\tonUserInput(userInputString);\n\t\t\tthis.scrollIntoView({ behavior: \"instant\" });\n\t\t}\n\t}, { passive: true });\n\n\treturn Object.freeze({\n\t\tlog,\n\t\tset prompt (value: string) {\n\t\t\tpromptElement.textContent = prompt = value;\n\t\t},\n\t\tget prompt () {{\n\t\t\treturn prompt;\n\t\t}},\n\t});\n}\n", "import type { Terminal } from \"./terminal\";\n\nexport function createGame () {\n\tfunction runCommand (terminal: Terminal, userInput: string) {\n\t\tuserInput = userInput.trim().replace(/\\s+/g, \" \");\n\t\tif (userInput === \"\") {\n\t\t\tterminal.log(\"\");\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const command of commands) {\n\t\t\tconst match = userInput.match(command.pattern);\n\t\t\tif (match) {\n\t\t\t\tcommand.run(terminal, ...match);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tterminal.log(\"Unknown command.\", \"error\");\n\t}\n\n\treturn Object.freeze({\n\t\trunCommand,\n\t});\n}\n\nexport type Command = {\n\tname: string,\n\tpattern: Parameters<typeof String.prototype.match>[0],\n\trun: (terminal: Terminal, ...match: string[]) => void,\n};\n\nexport const commands: Command[] = [\n\t{\n\t\tname: \"look around\",\n\t\tpattern: /^look around$/i,\n\t\trun (terminal) {\n\t\t\tterminal.log(\"There isn't much to see yet.\");\n\t\t},\n\t},\n\t{\n\t\tname: \"add ITEM\",\n\t\tpattern: /^(add|put|drop)(.*)/i,\n\t\trun (terminal, match, verb, item) {\n\t\t\tterminal.log(`You ${verb} ${item.trim()} in the cauldron. For flavor.`);\n\t\t},\n\t},\n\t{\n\t\tname: \"borrow ITEM\",\n\t\tpattern: /^(borrow|fetch|grab|pick(?:up)?|retrieve|steal|take|yoink)(.*)/i,\n\t\trun (terminal, match, verb, item) {\n\t\t\titem = item.trim() || \"something\";\n\t\t\tconst itemExists = true;\n\n\t\t\tif (itemExists) {\n\t\t\t\tterminal.log(`You ${verb === \"yoink\" ? \"pretend you're Homer Simpsons and yoink\" : verb} some ${item} from the chest.`);\n\t\t\t} else {\n\t\t\t\tterminal.log(`You can't find any ${item} in the chest.`);\n\t\t\t}\n\t\t},\n\t},\n\t{\n\t\tname: \"help\",\n\t\tpattern: /^help\\b/i,\n\t\trun (terminal) {\n\t\t\tterminal.log(\"\\n      b u t    n o b o d y    c a m e.\\n\\n\");\n\t\t\tconst hack = document.querySelector(\".command-input\") as HTMLInputElement;\n\t\t\thack.disabled = true;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tterminal.log([\n\t\t\t\t\t\"...fine, printing list of available commands.\",\n\t\t\t\t\t...commands.map(c => \"    \" + c.name),\n\t\t\t\t].join(\"\\n\"));\n\t\t\t\thack.disabled = false;\n\t\t\t\thack.scrollIntoView();\n\t\t\t\thack.focus();\n\t\t\t}, 3000);\n\t\t}\n\t},\n\t{\n\t\tname: \"make me a sandwich\",\n\t\tpattern: /^(sudo )?make me a sandwich$/i,\n\t\trun (terminal, match, sudo) {\n\t\t\tif (sudo) {\n\t\t\t\tterminal.log(\"Poof, you're a sandwich.\");\n\t\t\t\tterminal.prompt = \"\uD83E\uDD6A \";\n\t\t\t} else {\n\t\t\t\tterminal.log(\"no.\");\n\t\t\t}\n\t\t},\n\t},\n\t{\n\t\tname: \"bash\",\n\t\tpattern: /^bash\\b|sh\\b/i,\n\t\trun (terminal) {\n\t\t\tterminal.prompt = terminal.prompt === \"\uD83E\uDD6A \" ? \"sandwich@chasm:~$ \" : \"alchemist@chasm:~$ \";\n\t\t},\n\t},\n\t{\n\t\tname: \"fortune\",\n\t\tpattern: /^fortune\\b/i,\n\t\trun (terminal) {\n\t\t\tterminal.log(\n\t\t\t\t\"Q: How many pirates does it take to change a lightbulb?\\nA: No more than 5, but they'll leave you 2 weeks in the dark first.\"\n\t\t\t);\n\t\t},\n\t},\n];\n", "import { ref, refArray } from \"./utils.js\";\nimport { createTerminal } from \"./terminal.js\";\nimport { createGame } from \"./game.js\";\n\nexport const rootClassList = document.documentElement.classList;\n\nref(\".settings [name=reduced-motion]\", HTMLInputElement)\n\t.addEventListener(\"change\", function onReducedMotionChange (event: Event) {\n\t\tif (this.checked) {\n\t\t\trootClassList.add(\"reduced-motion\");\n\t\t} else {\n\t\t\trootClassList.remove(\"reduced-motion\");\n\t\t}\n\t}, { passive: true });\n\nrefArray(\".settings [name=color-scheme]\", HTMLInputElement)\n\t.forEach(el =>\n\t\tel.addEventListener(\"change\", onColorSchemeChange, { passive: true }));\n\nfunction onColorSchemeChange (this: HTMLInputElement) {\n\tArray.from(rootClassList)\n\t\t.filter(name => name.startsWith(\"theme-\"))\n\t\t.forEach(name => rootClassList.remove(name));\n\trootClassList.add(`theme-${this.value}`);\n}\n\nconst terminal = createTerminal({\n\tinputElement: ref(\".command-input\", HTMLInputElement),\n\toutputElement: ref(\".output-log\", HTMLElement),\n\tpromptElement: ref(\".command-prompt\", HTMLElement),\n\tonUserInput (userInput: string) {\n\t\tgame.runCommand(terminal, userInput);\n\t},\n});\n\nconst game = createGame();\n"],
  "mappings": "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",
  "names": ["ref", "selector", "constructor", "el", "refArray", "arr", "intruder", "createTerminal", "promptElement", "inputElement", "outputElement", "onUserInput", "samp", "prompt", "echo", "userInput", "kbdElement", "log", "message", "loglevel", "span", "event", "userInputString", "value", "createGame", "runCommand", "terminal", "userInput", "command", "commands", "match", "verb", "item", "hack", "c", "sudo", "rootClassList", "ref", "event", "refArray", "el", "onColorSchemeChange", "name", "terminal", "createTerminal", "userInput", "game", "createGame"]
}
